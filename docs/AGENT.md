# tara-agent Configuration Guide

## Overview

`tara-agent` is the data collector binary. It runs on the target machine, scrapes system metrics, and sends them to the `tara-server`.

## Configuration

The agent is configured entirely via Environment Variables.

| Variable | Default | Description |
| :--- | :--- | :--- |
| `SERVER_URL` | `http://localhost:8080` | The full base URL of the `tara-server` ingestion engine. |
| `AGENT_TOKEN` | *None* | **Required**. The secure Bearer Token generated by the server. |
| `AGENT_INTERVAL` | `1s` | The frequency of metric collection (e.g., `1s`, `500ms`, `5s`). |
| `LOG_LEVEL` | `info` | JSON logger verbosity (`debug`, `info`, `warn`, `error`). |

## Running the Agent

### 1. Prerequisites
- `agent-cli` binary (compiled via `go build -o bin/agent-cli cmd/agent-cli/main.go`)
- Server URL (e.g., `http://localhost:8080`)

### 2. Execution (Flags)

The modern agent uses command-line flags for easy configuration:

```bash
# Run with manual ID
./bin/agent-cli --server="http://10.0.0.5:8080" --id="rack-A-server-1" --interval=1

# Run with automatic ID (uses MAC address)
./bin/agent-cli --server="http://10.0.0.5:8080"
```

| Flag | Description | Default |
| :--- | :--- | :--- |
| `--server` | taraSysDash server endpoint | `http://localhost:8080` |
| `--id` | Unique identifier (MAC used if empty) | *Auto-generated* |
| `--interval` | Collection interval in seconds | `1` |

### 3. Systemd Service (Example)

Create `/etc/systemd/system/tara-agent.service`:

```ini
[Unit]
Description=TaraSysDash Agent
After=network.target

[Service]
ExecStart=/usr/local/bin/tara-agent
Environment="SERVER_URL=http://192.168.1.10:8080"
Environment="AGENT_TOKEN=a1b2c3d4..."
Restart=always

[Install]
WantedBy=multi-user.target
```
